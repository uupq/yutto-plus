# Yutto-Batch WebUI

基于Flask + Socket.IO的Web用户界面，为`yutto-batch`提供友好的图形化操作界面。

## ✨ 功能特性

- 🎯 **批量下载管理** - 支持所有yutto-batch的URL类型
- 📊 **实时任务监控** - WebSocket实时显示下载进度和日志
- 🔄 **断点续传** - 自动识别已下载内容，智能续传
- 📋 **批量更新** - 一键更新所有任务，获取最新内容
- 📱 **响应式设计** - 支持桌面和移动设备
- 🌟 **用户友好** - 直观的界面设计，简单易用

## 🚀 快速开始

### 1. 安装依赖

```bash
# 在 tools/yutto-batch 目录下执行
pip install -r webui_requirements.txt
```

### 2. 启动WebUI

```bash
python start_webui.py
```

### 3. 访问界面

启动后会自动打开浏览器，或手动访问显示的地址（端口在15000-65535之间随机选择）

## 📖 界面说明

### 主页 - 下载管理
- **URL输入**：支持B站各种类型的URL
- **配置选项**：输出目录、Cookie、VIP模式等
- **支持类型**：投稿视频、番剧、收藏夹、个人空间等
- **实时状态**：显示当前运行中的任务

### 批量更新页面
- **扫描功能**：自动扫描输出目录中的所有任务
- **进度显示**：显示每个任务的完成情况
- **智能更新**：只下载新增的视频内容

### 任务状态页面
- **统计面板**：运行中、已完成、失败任务统计
- **实时监控**：运行中任务的实时状态
- **本地管理**：查看和管理本地任务文件夹
- **详情查看**：查看任务的详细信息

## 🎮 使用指南

### 下载单个URL
1. 在主页输入B站URL
2. 设置输出目录（默认：~/Downloads）
3. 如需要，填入SESSDATA Cookie
4. 选择相关选项（VIP模式、调试等）
5. 点击"开始下载"

### 批量更新所有任务
1. 转到"批量更新"页面
2. 设置包含所有任务的根目录
3. 点击"扫描任务"查看现有任务
4. 填入Cookie（如需要）
5. 点击"开始批量更新"

### 查看任务状态
1. 转到"任务状态"页面
2. 查看运行中任务的实时状态
3. 扫描本地任务文件夹
4. 点击"详情"查看具体任务信息

## 🔧 高级功能

### VIP严格模式
启用后下载最高质量的VIP内容，需要有效的会员Cookie。

### 调试模式
显示详细的调试日志，用于问题排查。

### 断点续传
自动识别已下载的视频，只下载缺失的内容。

### CSV状态管理
每个任务自动创建CSV文件记录下载状态，支持断点续传。

## 🔗 支持的URL类型

| 类型 | URL示例 | 功能 |
|------|---------|------|
| 投稿视频 | `https://www.bilibili.com/video/BV...` | 支持多P批量下载 |
| 番剧 | `https://www.bilibili.com/bangumi/play/ss...` | 下载所有集数 |
| 收藏夹 | `https://space.bilibili.com/.../favlist?fid=...` | 收藏夹内容 |
| 个人空间 | `https://space.bilibili.com/123456` | UP主所有投稿 |
| 课程 | `https://www.bilibili.com/cheese/play/ss...` | B站课程内容 |
| 视频列表 | 各种播放列表URL | 列表中所有视频 |
| 稍后再看 | 稍后再看页面URL | 稍后再看列表 |

## 🛠️ 技术架构

- **后端**: Flask + Flask-SocketIO
- **前端**: Bootstrap 5 + Socket.IO客户端
- **实时通信**: WebSocket
- **任务管理**: 异步线程 + CSV状态文件
- **下载核心**: 调用原版yutto命令

## 📁 文件结构

```
tools/yutto-batch/
├── webui/                  # WebUI核心文件
│   ├── app.py             # Flask主应用
│   ├── templates/         # HTML模板
│   └── static/           # 静态资源
├── start_webui.py        # 启动脚本
├── webui_requirements.txt # WebUI依赖
└── WEBUI_README.md       # 使用说明
```

## 🐛 故障排除

### 常见问题

1. **无法访问WebUI**
   - 检查防火墙设置
   - 程序会自动选择15000-65535范围内的可用端口
   - 如果浏览器未自动打开，请手动访问控制台显示的地址

2. **下载失败**
   - 检查网络连接
   - 验证SESSDATA Cookie有效性
   - 查看实时日志获取详细错误信息

3. **权限问题**
   - 确保输出目录有写入权限
   - 某些内容需要登录Cookie

### 获取Cookie

1. 登录bilibili.com
2. 打开浏览器开发者工具（F12）
3. 转到Application/Storage → Cookies
4. 找到`SESSDATA`字段，复制其值

## 📝 更新日志

### v1.0.0
- ✅ 完整的Web界面
- ✅ 实时任务监控
- ✅ 批量更新功能
- ✅ 断点续传支持
- ✅ 响应式设计

## 📄 许可证

本WebUI遵循与yutto-batch主项目相同的许可证。 